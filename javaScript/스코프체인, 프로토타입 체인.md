## 스코프 체인과 프로토타입 체인

스코프 체인과 프로토타입 체인은 연관없이 별도로 동작하는 것이 아니고, 서로 협력하여 식별자와 프로퍼티를 검색하는데 사용된다.

### 스코프 체인

- 프로퍼티가 아닌 **식별자 검색**
- **함수의 중첩 관계**로 이루어진 스코프의 계층적 구조에서 식별자를 검색한다.

  ```javascript
  var x = 1;

  function foo() {
    var y = 2;

    function bar() {
      var z = 3;
    }
  }
  ```

  전역 객체 > foo 함수 > bar 함수

- 렉시컬 환경의 연속에서 검색한다
  1. 현재 실행중인 실행 컨텍스트의 렉시컬 환경에서 검색한다.
  2. 없으면, 외부 렉시컬 환경에 대한 참조에서 상위 스코프로 이동하여, 그 상위 스코프의 렉시컬 환경에서 검색한다.
  3. 스코프 체인을 따라 메서드를 계속 검색한다.
  4. 스코프 체인의 최상위 객체는 전역 객체이므로, 가장 상위까지 올라가면 전역 객체의 렉시컬 환경에서 검색하게 된다.

### 프로토타입 체인

- 프로퍼티와 메서드 검색
- **객체 간의 상속 관계**로 이루어진 프로토타입의 계층적 구조에서 객체의 프로퍼티 검색
- 프로토타입 체인 검색 매커니즘
  1. 메서드를 호출한 객체에서 메서드를 검색한다.
  2. 없으면, `[[Prototype]]` 내부 슬롯에 바인딩되어 있는 프로토타입으로 이동하여 메서드를 검색한다.
  3. 프로토타입 체인을 따라 메서드를 계속 검색한다.
  4. 자바스크립트 엔진은 메서드가 존재하는 객체의 메서드를 호출한다. 메서드의 `this`에는 호출한 객체가 바인딩된다.
- 프로토타입의 최상위 객체는 항상 `Object.prototype`이다.
